import{_ as T}from"./DialogCloseBtn-c3f54192.js";import{al as j,r as O,am as $,$ as N,s as w,o as l,c as g,w as e,d as t,g as h,a4 as q,i as y,j as _,aW as P,x as b,G as S,A as C,f as p,e as V,H as k,ad as R,ae as U,p as A,a as M,aV as E,aG as G,a6 as H,m as F,l as W}from"./index-4d7bce60.js";import{V as B,a as x}from"./VList-c122c8f0.js";import{V as Y}from"./VDivider-e667177b.js";import{V as z,a as v}from"./VRow-2d51bd7c.js";import{V as J}from"./VDialog-e43dd751.js";import{V as K,a as Q}from"./VToolbar-303bfef3.js";import{V as X}from"./VSpacer-6b692459.js";import"./dialog-transition-5a768d73.js";const I=j("order",()=>{const i=O({}),n=O({});async function r(){try{const{data:s}=await $.get("/orders");i.value=s.data.sort((a,f)=>f.id-a.id)}catch(s){return Promise.reject(s)}}async function m(s){try{const{data:a}=await $.get(`/orders/${s}/order_details`);n.value=a.data}catch(a){return Promise.reject(a)}}return{orderList:i,orderDetail:n,getOrder:r,getOrderDetail:m}});const L=i=>(R("data-v-f341a24e"),i=i(),U(),i),Z=L(()=>V("div",null,"Date",-1)),ee=L(()=>V("div",null,"Method",-1)),te={__name:"OrderDetailDialog",props:{targerOrder:{type:Object,required:!0},isDialogVisible:{type:Boolean,required:!0}},emits:["submit","update:isDialogVisible"],setup(i,{emit:n}){const r=i,m=I(),s=D=>{n("update:isDialogVisible",D)},a=w(()=>r.targerOrder.payment_status==="paid"?"success":"error"),f=w(()=>{if(r.targerOrder.payment_method==="credit_card")return"mdi-credit-card";if(r.targerOrder.payment_method==="bank-transfer")return"mdi-bank-transfer";if(r.targerOrder.payment_method==="cash_on_delivery")return"mdi-cash"});return(D,o)=>{const d=T;return l(),g(J,{width:500,"model-value":r.isDialogVisible,"onUpdate:modelValue":s},{default:e(()=>[t(d,{onClick:o[0]||(o[0]=u=>s(!1))}),t(h,{class:"pa-5"},{default:e(()=>[t(q,null,{default:e(()=>[y(" Order: "+_(r.targerOrder.order_no),1)]),_:1}),t(P,null,{default:e(()=>[y(" Detail ")]),_:1}),t(B,null,{default:e(()=>[(l(!0),b(S,null,C(p(m).orderDetail,u=>(l(),b(S,{key:u.id},[t(x,{title:u.race_name,subtitle:`x ${u.quantity}`},{append:e(()=>[V("div",null,_(`$${u.subtotal_price}`),1)]),_:2},1032,["title","subtitle"]),t(Y)],64))),128)),t(x,null,{default:e(()=>[t(z,null,{default:e(()=>[t(v,{cols:"4"},{default:e(()=>[Z,V("div",null,_(new Date(r.targerOrder.created_at).toLocaleDateString()),1)]),_:1}),t(v,{cols:"4",class:"text-center"},{default:e(()=>[ee,t(k,{color:p(a)},{default:e(()=>[y(_(p(f)),1)]),_:1},8,["color"])]),_:1}),t(v,{cols:"4",class:"d-flex align-center justify-end"},{default:e(()=>[V("div",null,"Total : $"+_(r.targerOrder.total_price),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}},re=N(te,[["__scopeId","data-v-f341a24e"]]),pe={__name:"order",setup(i){const n=I(),r=A(),m=M(),s=E(),a=O(!1),f=O({});G(async()=>{try{const{status:o,order:d}=s.query;o&&d&&(r.message=`Order_No: ${d} Status:${o}`,r.isShow=!0,r.timeout=1e4,r.noticeType(o==="SUCCESS")),m.replace("/order"),await n.getOrder()}catch{m.replace("/login")}});async function D(o){try{await n.getOrderDetail(o.id),f.value=o,a.value=!0}catch{}}return(o,d)=>{const u=re;return l(),b("div",null,[t(h,{class:"mx-auto"},{default:e(()=>[t(K,{color:"primary"},{default:e(()=>[t(Q,null,{default:e(()=>[y("Order History")]),_:1}),t(X)]),_:1}),p(n).orderList.length?(l(),g(B,{key:0},{default:e(()=>[(l(!0),b(S,null,C(p(n).orderList,c=>(l(),g(x,{key:c.id,title:`Order No : ${c.order_no}`,subtitle:`Status : ${c.payment_status}`},{prepend:e(()=>[t(H,null,{default:e(()=>[c.payment_status==="paid"?(l(),g(k,{key:0,color:"success"},{default:e(()=>[y(_("mdi-clipboard-text"))]),_:1})):(l(),g(k,{key:1,color:"error"},{default:e(()=>[y(_("mdi-error"))]),_:1}))]),_:2},1024)]),append:e(()=>[t(F,{onClick:ae=>D(c),color:"grey-lighten-1",icon:"mdi-receipt-text-check-outline",variant:"text"},null,8,["onClick"])]),_:2},1032,["title","subtitle"]))),128))]),_:1})):(l(),g(h,{key:1,subtitle:"You haven't purchased anything yet!"}))]),_:1}),t(u,{isDialogVisible:p(a),"onUpdate:isDialogVisible":d[0]||(d[0]=c=>W(a)?a.value=c:null),targerOrder:p(f)},null,8,["isDialogVisible","targerOrder"])])}}};export{pe as default};
